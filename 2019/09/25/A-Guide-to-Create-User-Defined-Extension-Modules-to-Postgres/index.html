<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres - Welcome to Cary&#39;s Blog</title>


    <meta name="description" content="1. OverviewPostgres is a huge database system consisting of a wide range of built-in data types, functions, features and operators that can be utilized to solve many common to complex problems. Howeve">
<meta property="og:type" content="article">
<meta property="og:title" content="A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres">
<meta property="og:url" content="http://yoursite.com/2019/09/25/A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres/index.html">
<meta property="og:site_name" content="Welcome to Cary&#39;s Blog">
<meta property="og:description" content="1. OverviewPostgres is a huge database system consisting of a wide range of built-in data types, functions, features and operators that can be utilized to solve many common to complex problems. Howeve">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/images/pg-thumbnail.png">
<meta property="article:published_time" content="2019-09-26T06:36:03.000Z">
<meta property="article:modified_time" content="2020-01-04T07:39:36.000Z">
<meta property="article:author" content="Cary Huang">
<meta property="article:tag" content="postgres">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/images/pg-thumbnail.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about/me.html">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="/images/pg-thumbnail.png" alt="A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-09-26T06:36:03.000Z">2019-09-25</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 minutes read (About 1916 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres
            
        </h1>
        <div class="content">
            <h4 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h4><p>Postgres is a huge database system consisting of a wide range of built-in data types, functions, features and operators that can be utilized to solve many common to complex problems. However, in the world full of complex problems, sometimes these are just not enough depending on the use case complexities.</p>
<p>Worry not, since Postgres version 9, it is possible to extend Postgres’s existing functionalities with the use of “extensions”</p>
<p>In this article, I will show you how to create your own extensions and add to Postgres.</p>
<p>Please note that this article is based on Postgres version 12 running on Ubuntu 18.04 and before you can create your own extensions, PG must have been built and installed first</p>
<h4 id="2-Built-in-Extensions"><a href="#2-Built-in-Extensions" class="headerlink" title="2. Built-in Extensions"></a>2. Built-in Extensions</h4><p>Before we jump into creating your own extensions, it is important to know that there is already a list of  extensions available from the PG community included in the Postgres software distribution. </p>
<p>The detailed information of community supplied extensions can be found in this link: <a href="https://www.postgresql.org/docs/9.1/contrib.html">https://www.postgresql.org/docs/9.1/contrib.html</a></p>
<h4 id="3-Build-and-Install-PG-Default-Extensions"><a href="#3-Build-and-Install-PG-Default-Extensions" class="headerlink" title="3. Build and Install PG Default Extensions"></a>3. Build and Install PG Default Extensions</h4><p>All the PG community extensions are located in the directory below. This is also where we will be adding our own extensions</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[PG SOURCE DIR]&#x2F;postgres&#x2F;contrib</span><br></pre></td></tr></table></figure>

<p>where [PG SOURCE DIR] is the directory to your PG source code</p>
<p>These modules are not built automatically unless you build the ‘world’ target. To Manually build and install them, use these commands.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd contrib</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<p>The above command will install the extensions to </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$SHAREDIR&#x2F;extension</span><br></pre></td></tr></table></figure>
<p>and required C shared libraries to </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$LIBDIR</span><br></pre></td></tr></table></figure>
<p>where $SHAREDIR and $LIBDIR are the values returned by pg_config</p>
<p>For the extensions that utilize the C language as implementation, there will be a C shared libraries (.so) being produced by the make command. This C shared library contains all the methods supported by the extension. </p>
<p>With default extensions and libraries installed, we can then see the installed extensions by the following queries</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT pg_available_extensions();</span><br><span class="line">SELECT pg_available_extension_versions();</span><br></pre></td></tr></table></figure>

<h4 id="4-Create-Extension-Using-plpqsql-Language"><a href="#4-Create-Extension-Using-plpqsql-Language" class="headerlink" title="4. Create Extension Using plpqsql Language"></a>4. Create Extension Using plpqsql Language</h4><p>For this example, we will create a very simple extension that will count the number of specified character of a given string. This extension takes 2 input arguments, first being the string, and second being the desired character. It will return an integer indicating the number of occurance of the desired characters presented in the string</p>
<p>first, let’s navigate to the contrib directory to add our extension</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd [PG SOURCE DIR]&#x2F;contrib</span><br></pre></td></tr></table></figure>

<p>let’s create a new directory called char_count. This will be the name of the extension</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir char_count</span><br><span class="line">cd char_count</span><br></pre></td></tr></table></figure>

<p>create the folders for defining testcases later</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir sql</span><br><span class="line">mkdir expected</span><br></pre></td></tr></table></figure>

<p>create and an extension control file using this naming convention:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Extension name].control</span><br></pre></td></tr></table></figure>

<p>in our case, it is:</p>
<p>char_count.control</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># char_count extension</span><br><span class="line">comment &#x3D; &#39;function to count number of specified characters&#39;</span><br><span class="line">default_version &#x3D; &#39;1.0&#39;</span><br><span class="line">module_pathname &#x3D; &#39;$libdir&#x2F;char_count&#39;</span><br><span class="line">relocatable &#x3D; true</span><br></pre></td></tr></table></figure>

<p>create a data sql file using this naming convention:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Extension name]--[Extension version].sql</span><br></pre></td></tr></table></figure>
<p>in our case, it is: </p>
<p>char_count–1.0.sql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">\echo Use &quot;CREATE EXTENSION char_count&quot; to load this file. \quit</span><br><span class="line">CREATE FUNCTION char_count(TEXT, CHAR)</span><br><span class="line">RETURNS INTEGER</span><br><span class="line">LANGUAGE plpgsql IMMUTABLE STRICT</span><br><span class="line">  AS $$</span><br><span class="line">    DECLARE</span><br><span class="line">      charCount INTEGER :&#x3D; 0;</span><br><span class="line">      i INTEGER :&#x3D; 0;</span><br><span class="line">      inputText TEXT :&#x3D; $1;</span><br><span class="line">      targetChar CHAR :&#x3D; $2;</span><br><span class="line">    BEGIN</span><br><span class="line">    WHILE i &lt;&#x3D; length(inputText) LOOP</span><br><span class="line">      IF substring( inputText from i for 1) &#x3D; targetChar THEN</span><br><span class="line">        charCount :&#x3D; charCount + 1;</span><br><span class="line">      END IF;</span><br><span class="line">        i :&#x3D; i + 1;</span><br><span class="line">      END LOOP;</span><br><span class="line"></span><br><span class="line">    RETURN(charCount);</span><br><span class="line">    END;</span><br><span class="line">  $$;</span><br></pre></td></tr></table></figure>

<p>Please note that the first echo line enforces the function to be loaded as extension</p>
<p>Create a Makefile</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># contrib&#x2F;char_count&#x2F;Makefile</span><br><span class="line"></span><br><span class="line">EXTENSION &#x3D; char_count</span><br><span class="line">DATA &#x3D; char_count--1.0.sql</span><br><span class="line">PGFILEDESC &#x3D; &quot;char_count - count number of specified character&quot;</span><br><span class="line">REGRESS &#x3D; char_count</span><br><span class="line"></span><br><span class="line">ifdef USE_PGXS</span><br><span class="line">PG_CONFIG &#x3D; pg_config</span><br><span class="line">PGXS :&#x3D; $(shell $(PG_CONFIG) --pgxs)</span><br><span class="line">include $(PGXS)</span><br><span class="line">else</span><br><span class="line">subdir &#x3D; contrib&#x2F;char_count</span><br><span class="line">top_builddir &#x3D; ..&#x2F;..</span><br><span class="line">include $(top_builddir)&#x2F;src&#x2F;Makefile.global</span><br><span class="line">include $(top_srcdir)&#x2F;contrib&#x2F;contrib-global.mk</span><br><span class="line">endif</span><br></pre></td></tr></table></figure>

<p>With the files in place ,we can go ahread and run within the char_count extension folder</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>This will install char_count extension to  $SHAREDIR</p>
<p>Now we can connect to the PG server and make use of the new extension that we have just added:</p>
<p><img src="/images/char_count-extension.png" alt="extension"></p>
<h4 id="5-Create-a-Test-Case-for-the-New-Extension"><a href="#5-Create-a-Test-Case-for-the-New-Extension" class="headerlink" title="5. Create a Test Case for the New Extension"></a>5. Create a Test Case for the New Extension</h4><p>We have already created a sql folder from previous steps, let’s create a new .sql file for our test case</p>
<p>char_count.sql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTENSION char_count;</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc&#39;,&#39;a&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc&#39;,&#39;b&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc&#39;,&#39;c&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;x&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;c&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;b&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;5&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;3&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;2&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;1&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;0&#39;);</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;asd&#39;);</span><br></pre></td></tr></table></figure>

<p>Please note that in the Makefile, we have to also specifiy the name of the regression tests with this line:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REGRESS &#x3D; char_count</span><br></pre></td></tr></table></figure>

<p>Run the testcase and Obtain Results</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make installcheck</span><br></pre></td></tr></table></figure>

<p>For the first time, the regression test will fail, because we have not provided the expected output file (.out file) for the test case. A new folder “results” is created upon running the regression test, and there is a (.out) file inside containing all the output from the test case</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTENSION char_count;</span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc&#39;,&#39;a&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          4</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc&#39;,&#39;b&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          7</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc&#39;,&#39;c&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          2</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;x&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          0</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;c&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          2</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;b&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          7</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;5&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          5</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;3&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          7</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;2&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          7</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;1&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          4</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;0&#39;);</span><br><span class="line"> char_count </span><br><span class="line">------------</span><br><span class="line">          1</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">SELECT char_count(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;asd&#39;);</span><br><span class="line">ERROR:  value too long for type character(1)</span><br><span class="line">CONTEXT:  PL&#x2F;pgSQL function char_count(text,character) line 7 during statement block local variable initialization</span><br></pre></td></tr></table></figure>

<p>We should examine this .out file and made sure the outputs are all correct and we will copy it over to the expected folder</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp char_count&#x2F;results&#x2F;char_count.out char_count&#x2F;expected</span><br></pre></td></tr></table></figure>

<h4 id="6-Create-your-Own-Extension-Using-C-Language"><a href="#6-Create-your-Own-Extension-Using-C-Language" class="headerlink" title="6. Create your Own Extension Using C Language"></a>6. Create your Own Extension Using C Language</h4><p>In the previous section, we created a extension using plpgsql function language. This is in many ways very similar to the ‘CREATE FUNCTION’ commands except that in the above example, we specifically states that the function can only be loaded through the CREATE EXTENSION command.</p>
<p>In most cases, the custom extensions are mostly built in C codes because of its flexibility and performance benefits.</p>
<p>To demonstrate this, we will create a new extension called char_count_c. Let’s repeat some of the process above:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd [PG_SOURCE_DIR]&#x2F;contrib</span><br><span class="line">mkdir char_count_c</span><br><span class="line">cd char_count_c</span><br><span class="line">mkdir expected</span><br><span class="line">mkdir sql</span><br></pre></td></tr></table></figure>

<p>create a control file for (char_count_c.control):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># char_count_c extension</span><br><span class="line">comment &#x3D; &#39;c function to count number of specified characters&#39;</span><br><span class="line">default_version &#x3D; &#39;1.0&#39;</span><br><span class="line">module_pathname &#x3D; &#39;$libdir&#x2F;char_count_c&#39;</span><br><span class="line">relocatable &#x3D; true</span><br></pre></td></tr></table></figure>

<p>create  a data sql file (char_count_c–1.0.sql)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\echo Use &quot;CREATE EXTENSION char_count&quot; to load this file. \quit</span><br><span class="line">CREATE FUNCTION char_count_c(TEXT, TEXT) RETURNS INTEGER</span><br><span class="line">AS &#39;$libdir&#x2F;char_count_c&#39;</span><br><span class="line">LANGUAGE C IMMUTABLE STRICT</span><br></pre></td></tr></table></figure>

<p>This is where it differs from the previous method to add extension. In here we specifically set the LANGUAGE to be C as oppose to plpgsql.</p>
<p>$libdir/char_count_c is important as this is the path in which the PG will try to find a corresponding C share library when char_count_c extension is loaded.</p>
<p>Now, create a Makefile</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MODULES &#x3D; char_count_c</span><br><span class="line">EXTENSION &#x3D; char_count_c</span><br><span class="line">DATA &#x3D; char_count_c--1.0.sql</span><br><span class="line">PGFILEDESC &#x3D; &quot;char_count_c - count number of specified character&quot;</span><br><span class="line">REGRESS &#x3D; char_count_c</span><br><span class="line"></span><br><span class="line">ifdef USE_PGXS</span><br><span class="line">PG_CONFIG &#x3D; pg_config</span><br><span class="line">PGXS :&#x3D; $(shell $(PG_CONFIG) --pgxs)</span><br><span class="line">include $(PGXS)</span><br><span class="line">else</span><br><span class="line">subdir &#x3D; contrib&#x2F;char_count_c</span><br><span class="line">top_builddir &#x3D; ..&#x2F;..</span><br><span class="line">include $(top_builddir)&#x2F;src&#x2F;Makefile.global</span><br><span class="line">include $(top_srcdir)&#x2F;contrib&#x2F;contrib-global.mk</span><br><span class="line">endif</span><br></pre></td></tr></table></figure>

<p>Here we added a new line called MODULES = char_count_c. This line will actually compile your C code into a shared library (.so) file which will be used by PG when char_count_c extension is loaded.</p>
<p>Create a new C source file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;postgres.h&quot;</span><br><span class="line">#include &quot;fmgr.h&quot;</span><br><span class="line">#include &quot;utils&#x2F;builtins.h&quot;</span><br><span class="line"></span><br><span class="line">PG_MODULE_MAGIC;</span><br><span class="line"></span><br><span class="line">PG_FUNCTION_INFO_V1(char_count_c);</span><br><span class="line"></span><br><span class="line">Datum</span><br><span class="line">char_count_c(PG_FUNCTION_ARGS)</span><br><span class="line">&#123;</span><br><span class="line">        int charCount &#x3D; 0;</span><br><span class="line">        int i &#x3D; 0;</span><br><span class="line">        text * inputText &#x3D; PG_GETARG_TEXT_PP(0);</span><br><span class="line">        text * targetChar &#x3D; PG_GETARG_TEXT_PP(1);</span><br><span class="line"></span><br><span class="line">        int inputText_sz &#x3D; VARSIZE(inputText)-VARHDRSZ;</span><br><span class="line">        int targetChar_sz &#x3D; VARSIZE(targetChar)-VARHDRSZ;</span><br><span class="line">        char * cp_inputText &#x3D; NULL;</span><br><span class="line">        char * cp_targetChar &#x3D; NULL;</span><br><span class="line"></span><br><span class="line">        if ( targetChar_sz &gt; 1 )</span><br><span class="line">        &#123;</span><br><span class="line">                elog(ERROR, &quot;arg1 must be 1 char long&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cp_inputText &#x3D; (char *) palloc ( inputText_sz + 1);</span><br><span class="line">        cp_targetChar &#x3D; (char *) palloc ( targetChar_sz + 1);</span><br><span class="line">        memcpy(cp_inputText, VARDATA(inputText), inputText_sz);</span><br><span class="line">        memcpy(cp_targetChar, VARDATA(targetChar), targetChar_sz);</span><br><span class="line"></span><br><span class="line">        elog(INFO, &quot;arg0 length is %d, value %s&quot;, (int)strlen(cp_inputText), cp_inputText );</span><br><span class="line">        elog(INFO, &quot;arg1 length is %d, value %s&quot;, (int)strlen(cp_targetChar), cp_targetChar );</span><br><span class="line"></span><br><span class="line">        while ( i &lt; strlen(cp_inputText) )</span><br><span class="line">        &#123;</span><br><span class="line">                if( cp_inputText[i] &#x3D;&#x3D; cp_targetChar[0] )</span><br><span class="line">                        charCount++;</span><br><span class="line">                i++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        pfree(cp_inputText);</span><br><span class="line">        pfree(cp_targetChar);</span><br><span class="line">        PG_RETURN_INT32(charCount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now we can compile the extension</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure>

<p>If make is successful, there should be a new C shared library created</p>
<p><img src="/images/c-make-shared.png" alt="extension"></p>
<p>Let’s go ahread and install</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>This will copy the<br>char_count_c–1.0.sql and char_count_c.control to $SHAREDIR/extension<br>and char_count_c.so to $LIBDIR</p>
<p>Make sure char_count_c.so is indeed installed to the $LIBDIR, otherwise, PG will not be able to find it when the extension is loaded.</p>
<p>With the extension installed, we can connect to the PG server and use the new extension</p>
<p><img src="/images/char_count_c_load.png" alt="extension"></p>
<p>Create a new test case in char_count_c/sql</p>
<p>let’s make a copy of the test case from previous “char_count” example and change the names to “char_count_c”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTENSION char_count_c;</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc&#39;,&#39;a&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc&#39;,&#39;b&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc&#39;,&#39;c&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;x&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;c&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;b&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;5&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;3&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;2&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;1&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;0&#39;);</span><br><span class="line">SELECT char_count_c(&#39;aaaabbbbbbbcc1111222222233333335555590&#39;,&#39;asd&#39;);</span><br></pre></td></tr></table></figure>

<p>Please note that in the Makefile, we have to also specifiy the name of the regression tests with this line:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REGRESS &#x3D; char_count_c</span><br></pre></td></tr></table></figure>

<p>Run the test case</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make installcheck</span><br></pre></td></tr></table></figure>

<p>copy the .out file to expected folder</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp char_count_c&#x2F;results&#x2F;char_count_c.out char_count_c&#x2F;expected</span><br></pre></td></tr></table></figure>

<h4 id="7-Add-the-new-extensions-to-global-Makefile"><a href="#7-Add-the-new-extensions-to-global-Makefile" class="headerlink" title="7. Add the new extensions to global Makefile"></a>7. Add the new extensions to global Makefile</h4><p>If you would like to have your extensions built along with the community ones, instead of building individually, you will need to modify the global extension Makefile located in [PG SOURCE DIR]/contrib/Makefile, and add:</p>
<p>char_count and char_count_c in SUBDIRS parameter</p>
<h4 id="8-Summary"><a href="#8-Summary" class="headerlink" title="8. Summary"></a>8. Summary</h4><p>Postgres is a very flexibile and powerful database system that provides different ways for the end users to extend existing functionalities to fulfill his or her business needs.</p>
<p>From the examples above, we have learned that since Postgres version 9, we are able to create new extensions using either plpgsql or C language and be able to create regression tests as part of the extension build to ensure the extensions will work as intended.</p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/postgres/" rel="tag">postgres</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2019/09/27/Trace-Postgres-query-processing-internals-with-debugger/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Trace-Postgres-query-processing-internals-with-debugger</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2019/09/25/A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function/">
                <span class="level-item">A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/prof-img.jpg" alt="Cary Huang">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Cary Huang
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Multi-Displined Software Developer
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Vancouver</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            5
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Category
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            1
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tag
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            1
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/caryhuang" target="_blank" rel="noopener">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/ppoffice">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Software-Development/">
            <span class="level-start">
                <span class="level-item">Software Development</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/postgres/" style="font-size: 10px;">postgres</a>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/10/29/Steaming-Replication-Setup-in-PG12-How-to-do-it-right/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="Steaming-Replication-Setup-in-PG12-How-to-do-it-right">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-10-30T06:36:39.000Z">2019-10-29</time></div>
                    <a href="/2019/10/29/Steaming-Replication-Setup-in-PG12-How-to-do-it-right/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Steaming-Replication-Setup-in-PG12-How-to-do-it-right</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/27/Replication-Failover-with-pg-rewind-in-PG12/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="Replication-Failover-with-pg_rewind-in-PG12">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-28T06:36:52.000Z">2019-09-27</time></div>
                    <a href="/2019/09/27/Replication-Failover-with-pg-rewind-in-PG12/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Replication-Failover-with-pg_rewind-in-PG12</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/27/Trace-Postgres-query-processing-internals-with-debugger/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="Trace-Postgres-query-processing-internals-with-debugger">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-28T06:36:24.000Z">2019-09-27</time></div>
                    <a href="/2019/09/27/Trace-Postgres-query-processing-internals-with-debugger/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Trace-Postgres-query-processing-internals-with-debugger</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/25/A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-26T06:36:03.000Z">2019-09-25</time></div>
                    <a href="/2019/09/25/A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres/" class="title has-link-black-ter is-size-6 has-text-weight-normal">A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/25/A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-26T05:32:25.000Z">2019-09-25</time></div>
                    <a href="/2019/09/25/A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function/" class="title has-link-black-ter is-size-6 has-text-weight-normal">A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">October 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">September 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/postgres/">
                        <span class="tag">postgres</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2019/10/29/Steaming-Replication-Setup-in-PG12-How-to-do-it-right/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="Steaming-Replication-Setup-in-PG12-How-to-do-it-right">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-10-30T06:36:39.000Z">2019-10-29</time></div>
                    <a href="/2019/10/29/Steaming-Replication-Setup-in-PG12-How-to-do-it-right/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Steaming-Replication-Setup-in-PG12-How-to-do-it-right</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/27/Replication-Failover-with-pg-rewind-in-PG12/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="Replication-Failover-with-pg_rewind-in-PG12">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-28T06:36:52.000Z">2019-09-27</time></div>
                    <a href="/2019/09/27/Replication-Failover-with-pg-rewind-in-PG12/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Replication-Failover-with-pg_rewind-in-PG12</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/27/Trace-Postgres-query-processing-internals-with-debugger/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="Trace-Postgres-query-processing-internals-with-debugger">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-28T06:36:24.000Z">2019-09-27</time></div>
                    <a href="/2019/09/27/Trace-Postgres-query-processing-internals-with-debugger/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Trace-Postgres-query-processing-internals-with-debugger</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/25/A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-26T06:36:03.000Z">2019-09-25</time></div>
                    <a href="/2019/09/25/A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres/" class="title has-link-black-ter is-size-6 has-text-weight-normal">A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/09/25/A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/pg-thumbnail.png" alt="A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-09-26T05:32:25.000Z">2019-09-25</time></div>
                    <a href="/2019/09/25/A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function/" class="title has-link-black-ter is-size-6 has-text-weight-normal">A-Guide-to-Basic-Postgres-Partition-Table-and-Trigger-Function</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Software-Development/">Software Development</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">October 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">September 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/postgres/">
                        <span class="tag">postgres</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="A-Guide-to-Create-User-Defined-Extension-Modules-to-Postgres" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Cary Huang&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'http://yoursite.com',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>